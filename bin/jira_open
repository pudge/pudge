#!/usr/bin/perl
my $proj = 'DEV';
my($id) = @ARGV;
$id ||= id(`git rev-parse --abbrev-ref HEAD`);
$id ||= id(`pbpaste`);

if ($id) {
    chomp $id;
    if ($id =~ /^(\d+)$/) {
        $id = "$proj-$id";
    }

    if ($id =~ /^\w+-\d+$/) {
        system 'open', "https://shiftboard.atlassian.net/browse/$id";
    }
}

sub id {
    my $id = shift;
    return $id =~ /(\w+-\d+)/ ? $1 : '';
}
