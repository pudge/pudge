function set_ps1 {
    local ptime puser phost phist ppwd pgit pchar
    ptime='\t'
    puser='\u'
    phost='${HOSTNAME}'
    phist='\[\e[36m\]\!\[\e[0m\]' # cyan
    ppwd='\[\e[35m\]\w\[\e[0m\]' # pink
    pgit='\[\e[37m\]$(__git_ps1 " (%s)")\[\e[0m\]' # grey
    pchar='\[\e[34m\]â†’\[\e[0m\]' # blue

#    PS1=$(printf "%*s\r%s\n\$ " "$(tput cols)" 'right' 'left')

#    export PS1="[$ptime] $phist $puser@$phost:$ppwd$pgit $pchar "
###    export PS1=$(printf "%${COLUMNS}s\r%s \$ " "$puser@$phost:$ppwd$pgit" "[$ptime] $phist$pchar")
    export PS1="$puser@$phost:$ppwd$pgit\n[$ptime] $phist$pchar "
}

function set_prompt {
    # for window title
    PROMPT_COMMAND='echo -ne "\033];${USER}@${HOSTNAME%.*.*}:${PWD/#$HOME/~}: \007"'
#    PROMPT_COMMAND="MYCODE=\$?; MYLASTHIST=\$(HISTTIMEFORMAT= history 1 | perl -pe 's/^[ \d]+//'); if [[ ! \${MYLASTHIST} =~ ' \#\d+$' ]]; then history -s \"\${MYLASTHIST} #\$MYCODE\"; fi; history -a; $PROMPT_COMMAND";
    export PROMPT_COMMAND
}

#alias winname="export PROMPT_COMMAND='echo -ne "\""\033]0;"'${WINNAME}'"\007"\""'"

function unset_prompt {
    unset PROMPT_COMMAND
    if [[ ! -z "$1" ]]; then
        printf "\e]1;$1\a"
    fi
}

export GIT_PS1_SHOWSTASHSTATE=1
export GIT_PS1_SHOWDIRTYSTATE=1
set_ps1
set_prompt

